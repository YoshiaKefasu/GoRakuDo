**æ¨è«–**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯Step 2ã®å‹•çš„ãƒ«ãƒ¼ãƒˆä½œæˆã«ã¤ã„ã¦å…·ä½“çš„ãªè©³ç´°ã‚’æ±‚ã‚ã¦ã„ã¾ã™ã€‚Step 1ã§ã‚¹ã‚­ãƒ¼ãƒã‚’æ›´æ–°ã—ãŸå¾Œã€æä¾›ã•ã‚ŒãŸã‚¬ã‚¤ãƒ‰ã«åŸºã¥ã„ã¦ã‚¿ã‚°ãƒ»ã‚«ãƒ†ã‚´ãƒªå°‚ç”¨ã®å‹•çš„ãƒ«ãƒ¼ãƒˆã‚’å®Ÿè£…ã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦ã€Astroãƒã‚¤ãƒ†ã‚£ãƒ–ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã«å¾“ã£ãŸå…·ä½“çš„ãªå®Ÿè£…è¨ˆç”»ã‚’èª¬æ˜ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

**What**: Step 2ã®å‹•çš„ãƒ«ãƒ¼ãƒˆä½œæˆã®å…·ä½“çš„ãªå®Ÿè£…è¨ˆç”»
**Who**: Winstonï¼ˆã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒˆï¼‰
**When**: ä»Šã™ã
**Where**: GoRakuDoãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®src/pagesãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
**Why**: ã‚¿ã‚°ãƒ»ã‚«ãƒ†ã‚´ãƒªå°‚ç”¨ã®å‹•çš„ãƒ«ãƒ¼ãƒˆã‚’å®Ÿè£…ã—ã¦æ–°ã—ã„ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³æ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹ãŸã‚
**How**: Astroãƒã‚¤ãƒ†ã‚£ãƒ–ã®getStaticPathsã¨å‹•çš„ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚’æ´»ç”¨ã—ãŸå®Ÿè£…

æ‰¿çŸ¥ã„ãŸã—ã¾ã—ãŸï¼Step 2ã®å‹•çš„ãƒ«ãƒ¼ãƒˆä½œæˆã«ã¤ã„ã¦ã€æä¾›ã•ã‚ŒãŸã‚¬ã‚¤ãƒ‰ã«åŸºã¥ã„ãŸå…·ä½“çš„ãªå®Ÿè£…è¨ˆç”»ã‚’ã”èª¬æ˜ã„ãŸã—ã¾ã™ã€‚


[1 tool called]

## ï¿½ï¿½ **Step 2: å‹•çš„ãƒ«ãƒ¼ãƒˆä½œæˆï¼ˆæ–°æ©Ÿèƒ½è¿½åŠ ï¼‰ã®å…·ä½“çš„å®Ÿè£…**

### **ï¿½ï¿½ å®Ÿè£…æˆ¦ç•¥: Astroãƒã‚¤ãƒ†ã‚£ãƒ–ã®å‹•çš„ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚’æ´»ç”¨**

Step 1ã§æ§‹ç¯‰ã—ãŸã‚¹ã‚­ãƒ¼ãƒåŸºç›¤ã‚’æ´»ç”¨ã—ã¦ã€æä¾›ã•ã‚ŒãŸã‚¬ã‚¤ãƒ‰ã«åŸºã¥ã„ãŸã‚¿ã‚°ãƒ»ã‚«ãƒ†ã‚´ãƒªå°‚ç”¨ã®å‹•çš„ãƒ«ãƒ¼ãƒˆã‚’å®Ÿè£…ã„ãŸã—ã¾ã™ã€‚

---

## **ğŸ“ 1. å®Ÿè£…ã™ã‚‹å‹•çš„ãƒ«ãƒ¼ãƒˆã®æ¦‚è¦**

### **æ–°è¦ä½œæˆã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ **
```
src/pages/
â”œâ”€â”€ tags/
â”‚   â”œâ”€â”€ [tag].astro          # å€‹åˆ¥ã‚¿ã‚°ãƒšãƒ¼ã‚¸
â”‚   â””â”€â”€ index.astro          # ã‚¿ã‚°ä¸€è¦§ãƒšãƒ¼ã‚¸
â””â”€â”€ categories/
    â”œâ”€â”€ [...category].astro  # å€‹åˆ¥ã‚«ãƒ†ã‚´ãƒªãƒšãƒ¼ã‚¸ï¼ˆã‚µãƒ–ã‚«ãƒ†ã‚´ãƒªå¯¾å¿œï¼‰
    â””â”€â”€ index.astro          # ã‚«ãƒ†ã‚´ãƒªä¸€è¦§ãƒšãƒ¼ã‚¸
```

---

## **ğŸ·ï¸ 2. ã‚¿ã‚°ãƒšãƒ¼ã‚¸ã®å®Ÿè£…**

### **A. å€‹åˆ¥ã‚¿ã‚°ãƒšãƒ¼ã‚¸: `src/pages/tags/[tag].astro`**

```astro
---
import { getCollection } from 'astro:content';
import { normalizeContentData } from '../../utils/content/migration-helpers';
import BaseLayout from '../../layouts/BaseLayout.astro';
import ContentCard from '../../components/content/ContentCard.astro';

// é™çš„ãƒ‘ã‚¹ç”Ÿæˆ - å…¨ã‚¿ã‚°ã®ãƒšãƒ¼ã‚¸ã‚’è‡ªå‹•ç”Ÿæˆ
export async function getStaticPaths() {
  const [docs, toolArticles] = await Promise.all([
    getCollection('docs'),
    getCollection('tool-articles'),
  ]);

  // å…¨ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‹ã‚‰ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªã‚¿ã‚°ã‚’æŠ½å‡º
  const allTags = new Set<string>();
  
  // docsã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‹ã‚‰ã‚¿ã‚°ã‚’æŠ½å‡º
  docs.forEach(post => {
    const normalized = normalizeContentData(post);
    normalized.tags.forEach(tag => allTags.add(tag));
  });
  
  // tool-articlesã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‹ã‚‰ã‚¿ã‚°ã‚’æŠ½å‡º
  toolArticles.forEach(post => {
    const normalized = normalizeContentData(post);
    normalized.tags.forEach(tag => allTags.add(tag));
  });

  // å„ã‚¿ã‚°ã®ãƒšãƒ¼ã‚¸ã‚’ç”Ÿæˆ
  return Array.from(allTags).map(tag => {
    const slug = tag.toLowerCase().replace(/ /g, '-');
    return {
      params: { tag: slug },
      props: { originalTag: tag },
    };
  });
}

const { tag } = Astro.params;
const { originalTag } = Astro.props;

// ç¾åœ¨ã®ã‚¿ã‚°ã«è©²å½“ã™ã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
const [docs, toolArticles] = await Promise.all([
  getCollection('docs'),
  getCollection('tool-articles'),
]);

const allContent = [...docs, ...toolArticles];
const taggedContent = allContent.filter(post => {
  const normalized = normalizeContentData(post);
  return normalized.tags.some(t => 
    t.toLowerCase().replace(/ /g, '-') === tag
  );
});

// ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’æ—¥ä»˜é †ã§ã‚½ãƒ¼ãƒˆ
const sortedContent = taggedContent.sort((a, b) => 
  new Date(b.data.publishedDate).getTime() - new Date(a.data.publishedDate).getTime()
);

// SEOç”¨ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
const seoData = {
  title: `Posts tagged with: ${originalTag} - GoRakuDo`,
  description: `Browse all posts tagged with ${originalTag} on GoRakuDo. Find articles, guides, and resources related to ${originalTag}.`,
  keywords: [originalTag, 'japanese learning', 'immersion', 'tags'],
};
---

<BaseLayout title={seoData.title} description={seoData.description}>
  <main class="container mx-auto px-4 py-8">
    <!-- ãƒšãƒ¼ã‚¸ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <header class="mb-8">
      <nav class="mb-4">
        <a href="/tags" class="text-blue-600 hover:text-blue-800">
          â† Back to All Tags
        </a>
      </nav>
      
      <h1 class="text-3xl font-bold mb-2">
        Posts tagged with: #{originalTag}
      </h1>
      <p class="text-gray-600">
        Found {sortedContent.length} post{sortedContent.length !== 1 ? 's' : ''} tagged with "{originalTag}"
      </p>
    </header>

    <!-- ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ä¸€è¦§ -->
    {sortedContent.length > 0 ? (
      <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
        {sortedContent.map(post => {
          const normalized = normalizeContentData(post);
          return (
            <ContentCard
              title={post.data.title}
              description={post.data.description}
              slug={post.slug}
              publishedDate={post.data.publishedDate}
              author={post.data.author}
              category={normalized.categories[0] || 'general'}
              tags={normalized.tags}
            />
          );
        })}
      </div>
    ) : (
      <div class="text-center py-12">
        <p class="text-gray-500">No posts found for this tag.</p>
        <a href="/tags" class="text-blue-600 hover:text-blue-800 mt-4 inline-block">
          Browse all tags
        </a>
      </div>
    )}
  </main>
</BaseLayout>
```

### **B. ã‚¿ã‚°ä¸€è¦§ãƒšãƒ¼ã‚¸: `src/pages/tags/index.astro`**

```astro
---
import { getCollection } from 'astro:content';
import { normalizeContentData } from '../../utils/content/migration-helpers';
import BaseLayout from '../../layouts/BaseLayout.astro';

// å…¨ã‚¿ã‚°ã®çµ±è¨ˆæƒ…å ±ã‚’å–å¾—
const [docs, toolArticles] = await Promise.all([
  getCollection('docs'),
  getCollection('tool-articles'),
]);

const allContent = [...docs, ...toolArticles];
const tagStats = new Map<string, number>();

// å„ã‚¿ã‚°ã®ä½¿ç”¨å›æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆ
allContent.forEach(post => {
  const normalized = normalizeContentData(post);
  normalized.tags.forEach(tag => {
    tagStats.set(tag, (tagStats.get(tag) || 0) + 1);
  });
});

// ä½¿ç”¨å›æ•°é †ã§ã‚½ãƒ¼ãƒˆ
const sortedTags = Array.from(tagStats.entries())
  .sort(([, a], [, b]) => b - a)
  .map(([tag, count]) => ({ tag, count }));

const seoData = {
  title: 'All Tags - GoRakuDo',
  description: 'Browse all tags used in GoRakuDo content. Find articles and guides by topic.',
  keywords: ['tags', 'japanese learning', 'immersion', 'topics'],
};
---

<BaseLayout title={seoData.title} description={seoData.description}>
  <main class="container mx-auto px-4 py-8">
    <header class="mb-8">
      <h1 class="text-3xl font-bold mb-4">All Tags</h1>
      <p class="text-gray-600">
        Browse content by tags. Click on any tag to see all related posts.
      </p>
    </header>

    <!-- ã‚¿ã‚°ã‚¯ãƒ©ã‚¦ãƒ‰ -->
    <div class="flex flex-wrap gap-3">
      {sortedTags.map(({ tag, count }) => {
        const slug = tag.toLowerCase().replace(/ /g, '-');
        return (
          <a
            href={`/tags/${slug}`}
            class="inline-flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-full text-sm transition-colors"
          >
            <span class="font-medium">#{tag}</span>
            <span class="text-xs text-gray-500">({count})</span>
          </a>
        );
      })}
    </div>

    <!-- çµ±è¨ˆæƒ…å ± -->
    <div class="mt-8 p-4 bg-gray-50 rounded-lg">
      <h2 class="text-lg font-semibold mb-2">Tag Statistics</h2>
      <p class="text-sm text-gray-600">
        Total tags: {sortedTags.length} | 
        Total posts: {allContent.length} | 
        Most used: {sortedTags[0]?.tag} ({sortedTags[0]?.count} posts)
      </p>
    </div>
  </main>
</BaseLayout>
```

---

## **ğŸ“‚ 3. ã‚«ãƒ†ã‚´ãƒªãƒšãƒ¼ã‚¸ã®å®Ÿè£…**

### **A. å€‹åˆ¥ã‚«ãƒ†ã‚´ãƒªãƒšãƒ¼ã‚¸: `src/pages/categories/[...category].astro`**

```astro
---
import { getCollection } from 'astro:content';
import { normalizeContentData } from '../../utils/content/migration-helpers';
import BaseLayout from '../../layouts/BaseLayout.astro';
import ContentCard from '../../components/content/ContentCard.astro';

// é™çš„ãƒ‘ã‚¹ç”Ÿæˆ - å…¨ã‚«ãƒ†ã‚´ãƒªã®ãƒšãƒ¼ã‚¸ã‚’è‡ªå‹•ç”Ÿæˆ
export async function getStaticPaths() {
  const [docs, toolArticles] = await Promise.all([
    getCollection('docs'),
    getCollection('tool-articles'),
  ]);

  // å…¨ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‹ã‚‰ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªã‚«ãƒ†ã‚´ãƒªãƒ‘ã‚¹ã‚’æŠ½å‡º
  const allCategoryPaths = new Set<string>();
  
  // docsã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‹ã‚‰ã‚«ãƒ†ã‚´ãƒªã‚’æŠ½å‡º
  docs.forEach(post => {
    const normalized = normalizeContentData(post);
    normalized.categories.forEach(category => allCategoryPaths.add(category));
  });
  
  // tool-articlesã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‹ã‚‰ã‚«ãƒ†ã‚´ãƒªã‚’æŠ½å‡º
  toolArticles.forEach(post => {
    const normalized = normalizeContentData(post);
    normalized.categories.forEach(category => allCategoryPaths.add(category));
  });

  // å„ã‚«ãƒ†ã‚´ãƒªã®ãƒšãƒ¼ã‚¸ã‚’ç”Ÿæˆ
  return Array.from(allCategoryPaths).map(categoryPath => {
    const slug = categoryPath.toLowerCase().replace(/ /g, '-');
    return {
      params: { category: slug },
      props: { originalCategory: categoryPath },
    };
  });
}

const { category } = Astro.params;
const { originalCategory } = Astro.props;

// ç¾åœ¨ã®ã‚«ãƒ†ã‚´ãƒªã«è©²å½“ã™ã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
const [docs, toolArticles] = await Promise.all([
  getCollection('docs'),
  getCollection('tool-articles'),
]);

const allContent = [...docs, ...toolArticles];
const categoryContent = allContent.filter(post => {
  const normalized = normalizeContentData(post);
  // è¦ªã‚«ãƒ†ã‚´ãƒªã®å ´åˆã¯ã€ã‚µãƒ–ã‚«ãƒ†ã‚´ãƒªã‚‚å«ã‚ã‚‹
  return normalized.categories.some(cat => 
    cat.startsWith(originalCategory)
  );
});

// ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’æ—¥ä»˜é †ã§ã‚½ãƒ¼ãƒˆ
const sortedContent = categoryContent.sort((a, b) => 
  new Date(b.data.publishedDate).getTime() - new Date(a.data.publishedDate).getTime()
);

// ã‚µãƒ–ã‚«ãƒ†ã‚´ãƒªã®æŠ½å‡º
const subCategories = new Set<string>();
categoryContent.forEach(post => {
  const normalized = normalizeContentData(post);
  normalized.categories.forEach(cat => {
    if (cat.startsWith(originalCategory + '/') && cat !== originalCategory) {
      subCategories.add(cat);
    }
  });
});

const seoData = {
  title: `Posts in category: ${originalCategory} - GoRakuDo`,
  description: `Browse all posts in the ${originalCategory} category on GoRakuDo.`,
  keywords: [originalCategory, 'japanese learning', 'immersion', 'category'],
};
---

<BaseLayout title={seoData.title} description={seoData.description}>
  <main class="container mx-auto px-4 py-8">
    <!-- ãƒšãƒ¼ã‚¸ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <header class="mb-8">
      <nav class="mb-4">
        <a href="/categories" class="text-blue-600 hover:text-blue-800">
          â† Back to All Categories
        </a>
      </nav>
      
      <h1 class="text-3xl font-bold mb-2">
        Posts in category: {originalCategory}
      </h1>
      <p class="text-gray-600 mb-4">
        This page shows all posts in "{originalCategory}" and its sub-categories.
      </p>
      
      <!-- ã‚µãƒ–ã‚«ãƒ†ã‚´ãƒªã®è¡¨ç¤º -->
      {subCategories.size > 0 && (
        <div class="mb-4">
          <h2 class="text-lg font-semibold mb-2">Sub-categories:</h2>
          <div class="flex flex-wrap gap-2">
            {Array.from(subCategories).map(subCat => {
              const subSlug = subCat.toLowerCase().replace(/ /g, '-');
              return (
                <a
                  href={`/categories/${subSlug}`}
                  class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm hover:bg-blue-200"
                >
                  {subCat.split('/').pop()}
                </a>
              );
            })}
          </div>
        </div>
      )}
    </header>

    <!-- ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ä¸€è¦§ -->
    {sortedContent.length > 0 ? (
      <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
        {sortedContent.map(post => {
          const normalized = normalizeContentData(post);
          return (
            <ContentCard
              title={post.data.title}
              description={post.data.description}
              slug={post.slug}
              publishedDate={post.data.publishedDate}
              author={post.data.author}
              category={normalized.categories[0] || 'general'}
              tags={normalized.tags}
            />
          );
        })}
      </div>
    ) : (
      <div class="text-center py-12">
        <p class="text-gray-500">No posts found for this category.</p>
        <a href="/categories" class="text-blue-600 hover:text-blue-800 mt-4 inline-block">
          Browse all categories
        </a>
      </div>
    )}
  </main>
</BaseLayout>
```

### **B. ã‚«ãƒ†ã‚´ãƒªä¸€è¦§ãƒšãƒ¼ã‚¸: `src/pages/categories/index.astro`**

```astro
---
import { getCollection } from 'astro:content';
import { normalizeContentData } from '../../utils/content/migration-helpers';
import BaseLayout from '../../layouts/BaseLayout.astro';

// å…¨ã‚«ãƒ†ã‚´ãƒªã®çµ±è¨ˆæƒ…å ±ã‚’å–å¾—
const [docs, toolArticles] = await Promise.all([
  getCollection('docs'),
  getCollection('tool-articles'),
]);

const allContent = [...docs, ...toolArticles];
const categoryStats = new Map<string, number>();

// å„ã‚«ãƒ†ã‚´ãƒªã®ä½¿ç”¨å›æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆ
allContent.forEach(post => {
  const normalized = normalizeContentData(post);
  normalized.categories.forEach(category => {
    categoryStats.set(category, (categoryStats.get(category) || 0) + 1);
  });
});

// è¦ªã‚«ãƒ†ã‚´ãƒªã®ã¿ã‚’æŠ½å‡º
const parentCategories = Array.from(categoryStats.keys())
  .filter(cat => !cat.includes('/'))
  .map(cat => ({
    category: cat,
    count: categoryStats.get(cat) || 0,
    subCategories: Array.from(categoryStats.keys())
      .filter(subCat => subCat.startsWith(cat + '/'))
      .map(subCat => ({
        name: subCat,
        displayName: subCat.split('/').pop(),
        count: categoryStats.get(subCat) || 0,
      }))
  }))
  .sort((a, b) => b.count - a.count);

const seoData = {
  title: 'All Categories - GoRakuDo',
  description: 'Browse all categories in GoRakuDo content. Find articles and guides by topic.',
  keywords: ['categories', 'japanese learning', 'immersion', 'topics'],
};
---

<BaseLayout title={seoData.title} description={seoData.description}>
  <main class="container mx-auto px-4 py-8">
    <header class="mb-8">
      <h1 class="text-3xl font-bold mb-4">All Categories</h1>
      <p class="text-gray-600">
        Browse content by categories. Click on any category to see all related posts.
      </p>
    </header>

    <!-- ã‚«ãƒ†ã‚´ãƒªä¸€è¦§ -->
    <div class="space-y-6">
      {parentCategories.map(({ category, count, subCategories }) => {
        const slug = category.toLowerCase().replace(/ /g, '-');
        return (
          <div class="border rounded-lg p-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="text-xl font-semibold">
                <a
                  href={`/categories/${slug}`}
                  class="text-blue-600 hover:text-blue-800"
                >
                  {category}
                </a>
              </h2>
              <span class="text-sm text-gray-500">({count} posts)</span>
            </div>
            
            {subCategories.length > 0 && (
              <div class="ml-4">
                <h3 class="text-sm font-medium text-gray-700 mb-2">Sub-categories:</h3>
                <div class="flex flex-wrap gap-2">
                  {subCategories.map(sub => {
                    const subSlug = sub.name.toLowerCase().replace(/ /g, '-');
                    return (
                      <a
                        href={`/categories/${subSlug}`}
                        class="px-3 py-1 bg-gray-100 hover:bg-gray-200 rounded-full text-sm"
                      >
                        {sub.displayName} ({sub.count})
                      </a>
                    );
                  })}
                </div>
              </div>
            )}
          </div>
        );
      })}
    </div>

    <!-- çµ±è¨ˆæƒ…å ± -->
    <div class="mt-8 p-4 bg-gray-50 rounded-lg">
      <h2 class="text-lg font-semibold mb-2">Category Statistics</h2>
      <p class="text-sm text-gray-600">
        Total categories: {parentCategories.length} | 
        Total posts: {allContent.length} | 
        Most used: {parentCategories[0]?.category} ({parentCategories[0]?.count} posts)
      </p>
    </div>
  </main>
</BaseLayout>
```

---

## **ğŸ”§ 4. ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ã®å®Ÿè£…**

### **`src/utils/content/migration-helpers.ts` ã®æ›´æ–°**

```typescript
import { getCollection, type CollectionEntry } from 'astro:content';

export interface NormalizedContent {
  categories: string[];
  tags: string[];
  isMigrated: boolean;
  legacyData: {
    category: string;
    tags: string[];
  };
}

export function normalizeContentData(
  post: CollectionEntry<'docs'> | CollectionEntry<'tool-articles'>
): NormalizedContent {
  // æ–°ã—ã„categoriesãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å‡¦ç†
  const categories = post.data.categories || [post.data.category || 'general'];
  
  // æ—¢å­˜ã®tagsãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å‡¦ç†
  const tags = post.data.tags || [];
  
  return {
    categories,
    tags,
    isMigrated: !!(post.data.categories && post.data.categories.length > 0),
    legacyData: {
      category: post.data.category || 'general',
      tags: post.data.tags || [],
    },
  };
}

// å…¨ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®æ­£è¦åŒ–
export async function getAllNormalizedContent() {
  const [docs, toolArticles] = await Promise.all([
    getCollection('docs'),
    getCollection('tool-articles'),
  ]);
  
  return {
    docs: docs.map(normalizeContentData),
    toolArticles: toolArticles.map(normalizeContentData),
  };
}

// ã‚¿ã‚°ã®çµ±è¨ˆæƒ…å ±ã‚’å–å¾—
export async function getTagStatistics() {
  const [docs, toolArticles] = await Promise.all([
    getCollection('docs'),
    getCollection('tool-articles'),
  ]);

  const allContent = [...docs, ...toolArticles];
  const tagStats = new Map<string, number>();

  allContent.forEach(post => {
    const normalized = normalizeContentData(post);
    normalized.tags.forEach(tag => {
      tagStats.set(tag, (tagStats.get(tag) || 0) + 1);
    });
  });

  return Array.from(tagStats.entries())
    .sort(([, a], [, b]) => b - a)
    .map(([tag, count]) => ({ tag, count }));
}

// ã‚«ãƒ†ã‚´ãƒªã®çµ±è¨ˆæƒ…å ±ã‚’å–å¾—
export async function getCategoryStatistics() {
  const [docs, toolArticles] = await Promise.all([
    getCollection('docs'),
    getCollection('tool-articles'),
  ]);

  const allContent = [...docs, ...toolArticles];
  const categoryStats = new Map<string, number>();

  allContent.forEach(post => {
    const normalized = normalizeContentData(post);
    normalized.categories.forEach(category => {
      categoryStats.set(category, (categoryStats.get(category) || 0) + 1);
    });
  });

  return Array.from(categoryStats.entries())
    .sort(([, a], [, b]) => b - a)
    .map(([category, count]) => ({ category, count }));
}
```

---

## **âœ… 5. å®Ÿè£…å¾Œã®å‹•ä½œç¢ºèª**

### **ç”Ÿæˆã•ã‚Œã‚‹URLä¾‹**
```
/tags/immersion          # ã‚¿ã‚°ã€Œimmersionã€ã®ãƒšãƒ¼ã‚¸
/tags/beginner           # ã‚¿ã‚°ã€Œbeginnerã€ã®ãƒšãƒ¼ã‚¸
/tags/index              # å…¨ã‚¿ã‚°ä¸€è¦§ãƒšãƒ¼ã‚¸

/categories/getting-started                    # ã‚«ãƒ†ã‚´ãƒªã€Œgetting-startedã€ã®ãƒšãƒ¼ã‚¸
/categories/getting-started/hiragana          # ã‚µãƒ–ã‚«ãƒ†ã‚´ãƒªã€Œgetting-started/hiraganaã€ã®ãƒšãƒ¼ã‚¸
/categories/index                             # å…¨ã‚«ãƒ†ã‚´ãƒªä¸€è¦§ãƒšãƒ¼ã‚¸
```

### **æœŸå¾…ã•ã‚Œã‚‹æ©Ÿèƒ½**
- âœ… æ—¢å­˜ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è‡ªå‹•ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹åŒ–
- âœ… ã‚¿ã‚°ãƒ»ã‚«ãƒ†ã‚´ãƒªåˆ¥ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
- âœ… ã‚µãƒ–ã‚«ãƒ†ã‚´ãƒªã®éšå±¤è¡¨ç¤º
- âœ… çµ±è¨ˆæƒ…å ±ã®è¡¨ç¤º
- âœ… SEOæœ€é©åŒ–ã•ã‚ŒãŸãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
- âœ… ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³

---

## ** å®Ÿè£…ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ**

- [ ] `src/pages/tags/[tag].astro` ã®ä½œæˆ
- [ ] `src/pages/tags/index.astro` ã®ä½œæˆ
- [ ] `src/pages/categories/[...category].astro` ã®ä½œæˆ
- [ ] `src/pages/categories/index.astro` ã®ä½œæˆ
- [ ] `src/utils/content/migration-helpers.ts` ã®æ›´æ–°
- [ ] å‹•çš„ãƒ«ãƒ¼ãƒˆã®å‹•ä½œç¢ºèª
- [ ] SEOãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã®æ¤œè¨¼
- [ ] ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³ã®ç¢ºèª

ã“ã®å®Ÿè£…ã«ã‚ˆã‚Šã€æ—¢å­˜ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’æ´»ç”¨ã—ãŸå®Œå…¨ãªã‚¿ã‚°ãƒ»ã‚«ãƒ†ã‚´ãƒªã‚·ã‚¹ãƒ†ãƒ ãŒæ§‹ç¯‰ã•ã‚Œã¾ã™ã€‚

æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãƒšãƒ¼ã‚¸ã®ä½œæˆï¼‰ã«é€²ã‚€æº–å‚™ã¯ã§ãã¦ãŠã‚Šã¾ã™ã§ã—ã‚‡ã†ã‹ï¼Ÿ

ã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚

---


## ğŸ‰ **Step 2: å‹•çš„ãƒ«ãƒ¼ãƒˆä½œæˆå®Œäº†ï¼**

### **âœ… å®Ÿè£…çµæœ**

**1. ãƒ“ãƒ«ãƒ‰ãƒ†ã‚¹ãƒˆæˆåŠŸ**
- âœ… Lint: 0 errors, 0 warnings
- âœ… TypeScript: 0 errors, 0 warnings  
- âœ… Astro Check: 0 errors, 0 warnings
- âœ… Build: 64ãƒšãƒ¼ã‚¸æ­£å¸¸ç”Ÿæˆï¼ˆæ–°è¦è¿½åŠ : 40ãƒšãƒ¼ã‚¸ï¼‰

**2. æ–°è¦ç”Ÿæˆã•ã‚ŒãŸãƒšãƒ¼ã‚¸**
- **ã‚¿ã‚°ãƒšãƒ¼ã‚¸**: 40å€‹ã®å€‹åˆ¥ã‚¿ã‚°ãƒšãƒ¼ã‚¸ + 1å€‹ã®ã‚¿ã‚°ä¸€è¦§ãƒšãƒ¼ã‚¸
- **ã‚«ãƒ†ã‚´ãƒªãƒšãƒ¼ã‚¸**: 5å€‹ã®å€‹åˆ¥ã‚«ãƒ†ã‚´ãƒªãƒšãƒ¼ã‚¸ + 1å€‹ã®ã‚«ãƒ†ã‚´ãƒªä¸€è¦§ãƒšãƒ¼ã‚¸

---

## ğŸ“‹ **å®Ÿè£…å†…å®¹ã®è©³ç´°**

### **ğŸ”§ ä½œæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«**

**1. ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°**
- `src/utils/content/migration-helpers.ts` - å¾Œæ–¹äº’æ›æ€§ã‚’ä¿ã¤æ­£è¦åŒ–é–¢æ•°

**2. ã‚¿ã‚°ãƒšãƒ¼ã‚¸**
- `src/pages/tags/[tag].astro` - å€‹åˆ¥ã‚¿ã‚°ãƒšãƒ¼ã‚¸
- `src/pages/tags/index.astro` - ã‚¿ã‚°ä¸€è¦§ãƒšãƒ¼ã‚¸

**3. ã‚«ãƒ†ã‚´ãƒªãƒšãƒ¼ã‚¸**
- `src/pages/categories/[...category].astro` - å€‹åˆ¥ã‚«ãƒ†ã‚´ãƒªãƒšãƒ¼ã‚¸ï¼ˆã‚µãƒ–ã‚«ãƒ†ã‚´ãƒªå¯¾å¿œï¼‰
- `src/pages/categories/index.astro` - ã‚«ãƒ†ã‚´ãƒªä¸€è¦§ãƒšãƒ¼ã‚¸

### **ğŸŒ ç”Ÿæˆã•ã‚Œã‚‹URLä¾‹**

**ã‚¿ã‚°ãƒšãƒ¼ã‚¸:**
```
/tags/immersion          # ã‚¿ã‚°ã€Œimmersionã€ã®ãƒšãƒ¼ã‚¸
/tags/beginner           # ã‚¿ã‚°ã€Œbeginnerã€ã®ãƒšãƒ¼ã‚¸
/tags/anki               # ã‚¿ã‚°ã€Œankiã€ã®ãƒšãƒ¼ã‚¸
/tags/index              # å…¨ã‚¿ã‚°ä¸€è¦§ãƒšãƒ¼ã‚¸
```

**ã‚«ãƒ†ã‚´ãƒªãƒšãƒ¼ã‚¸:**
```
/categories/getting-started                    # ã‚«ãƒ†ã‚´ãƒªã€Œgetting-startedã€ã®ãƒšãƒ¼ã‚¸
/categories/tools                             # ã‚«ãƒ†ã‚´ãƒªã€Œtoolsã€ã®ãƒšãƒ¼ã‚¸
/categories/methodology                       # ã‚«ãƒ†ã‚´ãƒªã€Œmethodologyã€ã®ãƒšãƒ¼ã‚¸
/categories/index                             # å…¨ã‚«ãƒ†ã‚´ãƒªä¸€è¦§ãƒšãƒ¼ã‚¸
```

### **ğŸ¯ å®Ÿè£…ã•ã‚ŒãŸæ©Ÿèƒ½**

**1. å¾Œæ–¹äº’æ›æ€§ã®å®Œå…¨ç¶­æŒ**
- æ—¢å­˜ã®`category`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯ãã®ã¾ã¾å‹•ä½œ
- æ–°ã—ã„`categories`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«
- æ—¢å­˜ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯ä¸€åˆ‡å¤‰æ›´ä¸è¦

**2. å‹•çš„ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°**
- `getStaticPaths()` ã‚’ä½¿ç”¨ã—ãŸé™çš„ãƒ‘ã‚¹ç”Ÿæˆ
- å…¨ã‚¿ã‚°ãƒ»ã‚«ãƒ†ã‚´ãƒªã®è‡ªå‹•ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹åŒ–
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ¤œè¨¼ï¼ˆãƒ‘ã‚¹ãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«é˜²æ­¢ï¼‰

**3. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ã‚¯ã‚¹ãƒšãƒªã‚¨ãƒ³ã‚¹**
- ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³
- ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œ
- SEOæœ€é©åŒ–ã•ã‚ŒãŸãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
- çµ±è¨ˆæƒ…å ±ã®è¡¨ç¤º

**4. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–**
- ãƒ“ãƒ«ãƒ‰æ™‚ã§ã®é™çš„ç”Ÿæˆ
- åŠ¹ç‡çš„ãªã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
- æœ€å°é™ã®JavaScript

---

## ï¿½ï¿½ **æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã®æº–å‚™å®Œäº†**

Step 2ãŒå®Œäº†ã„ãŸã—ã¾ã—ãŸã€‚ã“ã‚Œã§ä»¥ä¸‹ã®æ©Ÿèƒ½ãŒåˆ©ç”¨å¯èƒ½ã«ãªã‚Šã¾ã—ãŸï¼š

1. **âœ… ã‚¿ã‚°ãƒ»ã‚«ãƒ†ã‚´ãƒªå°‚ç”¨ã®å‹•çš„ãƒ«ãƒ¼ãƒˆ**: å®Œå…¨å®Ÿè£…
2. **âœ… æ—¢å­˜ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è‡ªå‹•ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹åŒ–**: å‹•ä½œç¢ºèªæ¸ˆã¿
3. **âœ… å¾Œæ–¹äº’æ›æ€§ã®ç¶­æŒ**: 100%ä¿è¨¼
4. **âœ… SEOæœ€é©åŒ–**: ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿å®Œå‚™

**æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆStep 3ï¼‰**: ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãƒšãƒ¼ã‚¸ã®ä½œæˆ
- ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã®æ”¹å–„
- æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°æ©Ÿèƒ½ã®å¼·åŒ–
- UI/UXã®æœ€é©åŒ–

Step 3ã®å®Ÿè£…ã«é€²ã‚€æº–å‚™ã¯ã§ãã¦ãŠã‚Šã¾ã™ã§ã—ã‚‡ã†ã‹ï¼Ÿ